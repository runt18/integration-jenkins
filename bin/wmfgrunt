#!/bin/bash

# Wikimedia wrapper to easily start out grunt with the continuous
# integration grunt file.

# Find out Jenkins home dir absolute path.
#
# bash does not provide any easy way to find out the real dir of the current
# script so we have to shell out cd to the relative path and then resolve it as
# an absolute path using pwd. The ksh equivalent is `whence`
BASE_DIR=$(cd $(dirname $0)/..; pwd)

# Paths to grunt-cli bin shared gruntfile:
GRUNT_BIN="$BASE_DIR/bin/grunt"
GRUNT_FILE="$BASE_DIR/tools/Gruntfile.js"

if [ ! -e "$GRUNT_BIN" -o ! -e "$GRUNT_FILE" ]; then
	echo "Either grunt or gruntfile.js could not be found. Expected:"
	echo "grunt        : $GRUNT_BIN"
	echo "gruntfile.js : $GRUNT_FILE"
	exit 1;
fi;

cd $BASE_DIR/tools
$GRUNT_BIN --gruntfile "$GRUNT_FILE" "$@"
